<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Header Component - Bendy Beth Design System</title>
    <link rel="stylesheet" href="../build/primitives.css">
    <link rel="stylesheet" href="../build/semantic.css">
    <link rel="stylesheet" href="../build/alias.css">
    <link rel="stylesheet" href="../src/components/header.css">
    <style>
        /* Demo styles */
        body {
            margin: 0;
            font-family: var(--bb-type-family-overused-grotesk, sans-serif);
        }

        .demo-section {
            margin: 2rem 0;
            padding: 1rem;
            background: #e5e7eb;
        }

        .demo-title {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="demo-section">
        <h2 class="demo-title">Default Header State</h2>
        <!-- Default Header -->
        <header class="bb-header" data-component="header" data-state="default">
            <div class="bb-header__logo-container">
                <div class="bb-header__logo">
                    <img
                        src="../public/logos/horizontal.svg"
                        alt="Bendy Beth Logo"
                        class="bb-header__logo-image"
                    >
                </div>
            </div>
        </header>
    </div>

    <div class="demo-section">
        <h2 class="demo-title">Hover Header State (with Cloud Video Background)</h2>
        <!-- Hover State Header with Video -->
        <header class="bb-header bb-header--hover" data-component="header" data-state="hover">
            <video
                class="bb-header__video-bg"
                autoplay
                muted
                loop
                playsinline
                preload="auto"
            >
                <source src="../public/videos/clouds_halfsize.mp4" type="video/mp4">
                <source src="../public/videos/clouds.mp4" type="video/mp4">
                <!-- Fallback image if video fails -->
                <img src="../public/images/clouds-600px.png" alt="Cloud background" style="width: 100%; height: 100%; object-fit: cover;">
            </video>
            <div class="bb-header__logo-container">
                <div class="bb-header__logo">
                    <img
                        src="../public/logos/horizontal.svg"
                        alt="Bendy Beth Logo"
                        class="bb-header__logo-image"
                    >
                </div>
            </div>
        </header>
    </div>

    <div class="demo-section">
        <h2 class="demo-title">Interactive Header (Hover to See Effect)</h2>
        <!-- Interactive Header -->
        <header class="bb-header bb-header--interactive" id="interactive-header" data-component="header">
            <video
                class="bb-header__video-bg"
                id="clouds-video"
                muted
                loop
                playsinline
                preload="metadata"
            >
                <source src="../public/videos/clouds_halfsize.mp4" type="video/mp4">
                <source src="../public/videos/clouds.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="bb-header__logo-container">
                <div class="bb-header__logo">
                    <img
                        src="../public/logos/horizontal.svg"
                        alt="Bendy Beth Logo"
                        class="bb-header__logo-image"
                    >
                </div>
            </div>
        </header>
    </div>

    <div class="demo-section">
        <h2 class="demo-title">Responsive Test</h2>
        <p style="text-align: center; margin-bottom: 1rem;">
            Resize your browser window to test responsive breakpoints:<br>
            <strong>Desktop:</strong> 1440px+ (96px padding, 622px logo)<br>
            <strong>Tablet:</strong> 1024px (64px padding, 311px logo)<br>
            <strong>Mobile:</strong> 768px (32px padding, 232.5px logo)
        </p>

        <header class="bb-header" data-component="header">
            <div class="bb-header__logo-container">
                <div class="bb-header__logo">
                    <img
                        src="../public/logos/horizontal.svg"
                        alt="Bendy Beth Logo"
                        class="bb-header__logo-image"
                    >
                </div>
            </div>
        </header>
    </div>

    <script>
        // Enhanced video debugging and path testing
        console.log('üé¨ Video Debug Information:');
        console.log('Current URL:', window.location.href);
        console.log('Base URL:', window.location.origin);

        // Test video path accessibility
        async function testVideoPath(path) {
            try {
                const response = await fetch(path, { method: 'HEAD' });
                console.log(`üìÅ Path "${path}": ${response.ok ? '‚úÖ Accessible' : '‚ùå Failed'} (${response.status})`);
                return response.ok;
            } catch (error) {
                console.log(`üìÅ Path "${path}": ‚ùå Network Error - ${error.message}`);
                return false;
            }
        }

        // Test all video paths
        const videoPaths = [
            '../public/videos/clouds_halfsize.mp4',
            '../public/videos/clouds.mp4',
            'public/videos/clouds_halfsize.mp4',
            '/public/videos/clouds_halfsize.mp4'
        ];

        Promise.all(videoPaths.map(testVideoPath)).then(results => {
            console.log('üìä Path Test Results:', results);
        });

        // Enhanced video event monitoring
        const allVideos = document.querySelectorAll('video');
        allVideos.forEach((video, index) => {
            const sources = video.querySelectorAll('source');
            console.log(`üé• Video ${index + 1} sources:`, Array.from(sources).map(s => s.src));

            // Comprehensive event listeners
            const events = ['loadstart', 'loadedmetadata', 'loadeddata', 'canplay', 'canplaythrough', 'playing', 'waiting', 'stalled', 'suspend', 'abort', 'error', 'emptied'];

            events.forEach(eventType => {
                video.addEventListener(eventType, (e) => {
                    if (eventType === 'error') {
                        const error = video.error;
                        console.error(`üö® Video ${index + 1} ERROR:`, {
                            code: error?.code,
                            message: error?.message,
                            type: ['MEDIA_ERR_ABORTED', 'MEDIA_ERR_NETWORK', 'MEDIA_ERR_DECODE', 'MEDIA_ERR_SRC_NOT_SUPPORTED'][error?.code - 1] || 'Unknown'
                        });
                    } else if (['canplay', 'loadeddata', 'playing'].includes(eventType)) {
                        console.log(`‚úÖ Video ${index + 1} ${eventType.toUpperCase()}:`, {
                            duration: video.duration,
                            videoWidth: video.videoWidth,
                            videoHeight: video.videoHeight,
                            readyState: video.readyState
                        });
                    } else {
                        console.log(`üì∫ Video ${index + 1} ${eventType.toUpperCase()}`);
                    }
                });
            });

            // Force load attempt
            video.load();
        });

        // Enhanced interactive hover effect
        const interactiveHeader = document.getElementById('interactive-header');
        const cloudsVideo = document.getElementById('clouds-video');

        if (interactiveHeader && cloudsVideo) {
            // Pre-load video
            cloudsVideo.load();

            interactiveHeader.addEventListener('mouseenter', async () => {
                console.log('üñ±Ô∏è Mouse ENTER - Starting video');
                interactiveHeader.classList.add('bb-header--hover');

                try {
                    // Wait a moment for transition, then play
                    setTimeout(async () => {
                        await cloudsVideo.play();
                        console.log('‚úÖ Video play successful');
                    }, 100);
                } catch (error) {
                    console.error('‚ùå Video play failed:', error);
                    // Fallback: try loading and playing again
                    cloudsVideo.load();
                    setTimeout(() => cloudsVideo.play().catch(e => console.error('Retry failed:', e)), 500);
                }
            });

            interactiveHeader.addEventListener('mouseleave', () => {
                console.log('üñ±Ô∏è Mouse LEAVE - Stopping video');
                interactiveHeader.classList.remove('bb-header--hover');
                cloudsVideo.pause();
                cloudsVideo.currentTime = 0;
            });

            // Monitor video readiness
            setInterval(() => {
                if (cloudsVideo.readyState >= 3) { // HAVE_FUTURE_DATA
                    console.log('üìä Video ready state: READY');
                }
            }, 5000);
        } else {
            console.error('‚ùå Interactive header or video element not found');
        }

        // Viewport logging
        function logViewportSize() {
            console.log(`üì± Viewport: ${window.innerWidth}px x ${window.innerHeight}px`);
        }

        window.addEventListener('resize', logViewportSize);
        logViewportSize();

        // Overall system check
        setTimeout(() => {
            console.log('üîç Final System Check:');
            console.log('- Videos found:', allVideos.length);
            console.log('- Interactive elements:', interactiveHeader ? '‚úÖ' : '‚ùå');
            console.log('- Target video element:', cloudsVideo ? '‚úÖ' : '‚ùå');
        }, 2000);
    </script>
</body>
</html>