<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }

        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        .test-section h2 {
            margin-top: 0;
            color: #333;
        }

        video {
            width: 100%;
            max-width: 600px;
            height: 200px;
            border: 1px solid #ccc;
        }

        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
        }

        .error { background: #ffe6e6; color: #d00; }
        .success { background: #e6ffe6; color: #080; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>Video Loading Debug Test</h1>

    <div class="test-section">
        <h2>Test 1: Direct Path with Controls</h2>
        <video id="test1" controls preload="metadata">
            <source src="../public/videos/clouds_halfsize.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div id="status1" class="status">Loading...</div>
    </div>

    <div class="test-section">
        <h2>Test 2: Alternative Path</h2>
        <video id="test2" controls preload="metadata">
            <source src="public/videos/clouds_halfsize.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div id="status2" class="status">Loading...</div>
    </div>

    <div class="test-section">
        <h2>Test 3: Absolute Path (Server Root)</h2>
        <video id="test3" controls preload="metadata">
            <source src="/public/videos/clouds_halfsize.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div id="status3" class="status">Loading...</div>
    </div>

    <div class="test-section">
        <h2>Test 4: Background Video Test</h2>
        <div style="position: relative; width: 100%; height: 200px; background: #f0f0f0; overflow: hidden;">
            <video id="test4" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;" autoplay muted loop>
                <source src="../public/videos/clouds_halfsize.mp4" type="video/mp4">
            </video>
            <div style="position: relative; z-index: 1; padding: 20px; color: white; text-shadow: 1px 1px 2px black;">
                Background Video Test
            </div>
        </div>
        <div id="status4" class="status">Loading...</div>
    </div>

    <div class="test-section">
        <h2>Network Information</h2>
        <div id="network-info" class="status">
            <strong>Current URL:</strong> <span id="current-url"></span><br>
            <strong>Base URL:</strong> <span id="base-url"></span><br>
            <strong>Server Status:</strong> <span id="server-status">Checking...</span>
        </div>
    </div>

    <script>
        // Display current URL info
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('base-url').textContent = window.location.origin;

        // Test server connectivity
        fetch('../public/videos/clouds_halfsize.mp4', { method: 'HEAD' })
            .then(response => {
                if (response.ok) {
                    document.getElementById('server-status').textContent = `‚úÖ Video accessible (${response.status})`;
                    document.getElementById('server-status').parentElement.classList.add('success');
                } else {
                    document.getElementById('server-status').textContent = `‚ùå Server error (${response.status})`;
                    document.getElementById('server-status').parentElement.classList.add('error');
                }
            })
            .catch(error => {
                document.getElementById('server-status').textContent = `‚ùå Network error: ${error.message}`;
                document.getElementById('server-status').parentElement.classList.add('error');
            });

        // Setup video event listeners
        for (let i = 1; i <= 4; i++) {
            const video = document.getElementById(`test${i}`);
            const status = document.getElementById(`status${i}`);

            video.addEventListener('loadstart', () => {
                status.textContent = 'üîÑ Loading started...';
                status.className = 'status warning';
            });

            video.addEventListener('loadedmetadata', () => {
                status.textContent = `‚úÖ Metadata loaded - Duration: ${video.duration.toFixed(1)}s`;
                status.className = 'status success';
            });

            video.addEventListener('canplay', () => {
                status.textContent = `‚úÖ Can play - Resolution: ${video.videoWidth}x${video.videoHeight}`;
                status.className = 'status success';
            });

            video.addEventListener('error', (e) => {
                const error = video.error;
                let errorMsg = '‚ùå Error: ';
                switch(error.code) {
                    case 1: errorMsg += 'MEDIA_ERR_ABORTED'; break;
                    case 2: errorMsg += 'MEDIA_ERR_NETWORK'; break;
                    case 3: errorMsg += 'MEDIA_ERR_DECODE'; break;
                    case 4: errorMsg += 'MEDIA_ERR_SRC_NOT_SUPPORTED'; break;
                    default: errorMsg += 'Unknown error';
                }
                status.textContent = errorMsg;
                status.className = 'status error';
                console.error(`Video ${i} error:`, error);
            });

            video.addEventListener('stalled', () => {
                status.textContent = '‚ö†Ô∏è Video stalled - network issues?';
                status.className = 'status warning';
            });
        }

        // Log all attempts
        console.log('Video debug page loaded');
        console.log('Testing paths:');
        console.log('1. ../public/videos/clouds_halfsize.mp4');
        console.log('2. public/videos/clouds_halfsize.mp4');
        console.log('3. /public/videos/clouds_halfsize.mp4');
    </script>
</body>
</html>